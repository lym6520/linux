<!DOCTYPE html>
<!-- saved from url=(0081)http://lesca.me/archives/iptables-tutorial-structures-configuratios-examples.html -->
<html class=" js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅</title> 
<meta name="description" content="iptables防火墙可以用于创建过滤(filter)与NAT规则。所有Linux发行版都能使用iptables，因此理解如何配置iptables将会帮助你更有效地管理Linux防火墙。如果你是第一次接触iptables，你会觉得它很复杂，但是一旦你理解iptables的工作原理，你会发现其实它很简单。">
<meta name="keywords" content="chain,iptables,rule,structure,table">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="./iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅_files/style.css" type="text/css" media="screen">
<link rel="shortcut icon" href="http://lesca.me/wp-content/themes/tangstyle/images/favicon.ico" type="image/x-icon">
<script src="./iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅_files/jquery.min.js"></script>
<script src="./iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅_files/theme.js"></script>
<link rel="alternate" type="application/rss+xml" title="Lesca技术宅 RSS Feed" href="http://lesca.me/feed">
<link rel="pingback" href="http://lesca.me/xmlrpc.php">
<link rel="alternate" type="application/rss+xml" title="Lesca技术宅 » iptables详细教程：基础、架构、清空规则、追加规则、应用实例 Comments Feed" href="http://lesca.me/archives/iptables-tutorial-structures-configuratios-examples.html/feed">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/lesca.me\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.4"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅_files/wp-emoji-release.min.js" type="text/javascript"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="https://api.w.org/" href="http://lesca.me/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://lesca.me/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://lesca.me/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Linux文件权限：Sticky bit, SUID, SGID" href="http://lesca.me/archives/linux-file-permission-sticky-bit-suid-sgid.html">
<link rel="next" title="iptables常用规则：屏蔽IP地址、禁用ping、协议设置、NAT与转发、负载平衡、自定义链" href="http://lesca.me/archives/iptables-examples.html">

<link rel="canonical" href="http://lesca.me/archives/iptables-tutorial-structures-configuratios-examples.html">
<link rel="shortlink" href="http://lesca.me/?p=937">
<link rel="alternate" type="application/json+oembed" href="http://lesca.me/wp-json/oembed/1.0/embed?url=http%3A%2F%2Flesca.me%2Farchives%2Fiptables-tutorial-structures-configuratios-examples.html">
<link rel="alternate" type="text/xml+oembed" href="http://lesca.me/wp-json/oembed/1.0/embed?url=http%3A%2F%2Flesca.me%2Farchives%2Fiptables-tutorial-structures-configuratios-examples.html&amp;format=xml">
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		</head>

<body>
<div id="background_wrap"></div>
<div id="wrap">
	
<div id="header">
    <div class="logo"><a href="http://lesca.me/">Lesca技术宅</a><p>Lesca，也就是我，求知若渴的技术宅，期待与您分享心得与收获，与您交换见解，讨论技术、科学、IT、哲学。</p></div>
    <div id="navigation">
    <ul id="nav"><li id="menu-item-356" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-356"><a href="http://lesca.me/topics/tutorial">教程 Tutorials</a></li>
<li id="menu-item-1055" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1055"><a href="http://lesca.me/topics/projects">项目 Projects</a>
<ul class="sub-menu">
	<li id="menu-item-992" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-992"><a href="http://lesca.me/topics/projects/ovm">VPN</a></li>
	<li id="menu-item-580" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-580"><a href="http://lesca.me/topics/projects/websh">Websh</a></li>
	<li id="menu-item-23" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-23"><a href="http://man.lesca.me/">Docs</a></li>
</ul>
</li>
<li id="menu-item-1078" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-1078"><a title="Operating System" href="http://lesca.me/topics/os">操作系统OS</a>
<ul class="sub-menu">
	<li id="menu-item-995" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-995"><a href="http://lesca.me/topics/os/ubuntu-2">Ubuntu</a>
	<ul class="sub-menu">
		<li id="menu-item-998" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-998"><a href="http://lesca.me/topics/os/kernel">Kernel</a></li>
		<li id="menu-item-997" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-997"><a href="http://lesca.me/topics/os/grub2">GRUB2</a></li>
		<li id="menu-item-996" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-996"><a href="http://lesca.me/topics/os/gdb">GDB</a></li>
	</ul>
</li>
	<li id="menu-item-1010" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1010"><a href="http://lesca.me/topics/os/windows">Windows</a></li>
</ul>
</li>
<li id="menu-item-1079" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-1079"><a title="Network" href="http://lesca.me/topics/network">网络Network</a>
<ul class="sub-menu" style="display: none;">
	<li id="menu-item-1301" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1301"><a href="http://lesca.me/topics/network/ipv6">IPv6</a></li>
	<li id="menu-item-1080" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1080"><a href="http://lesca.me/topics/network/apache">Apache</a></li>
	<li id="menu-item-1083" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1083"><a href="http://lesca.me/topics/network/php">PHP</a></li>
	<li id="menu-item-1081" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1081"><a href="http://lesca.me/topics/network/http">HTTP</a></li>
	<li id="menu-item-1085" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1085"><a href="http://lesca.me/topics/network/web">Web</a></li>
	<li id="menu-item-1084" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1084"><a href="http://lesca.me/topics/network/socket">SOCKET</a></li>
	<li id="menu-item-1082" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1082"><a href="http://lesca.me/topics/network/iptables">iptables</a></li>
</ul>
</li>
<li id="menu-item-25" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25"><a href="http://download.lesca.me/">下载 Downloads</a></li>
<li id="menu-item-24" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24"><a href="http://lesca.me/about">留言 Guestbook</a></li>
<li id="menu-item-1019" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1019"><a title="搜索本站" href="http://lesca.me/search">搜索本站 Search</a></li>
</ul><select class="selectnav" id="selectnav1"><option value="">[选择频道]</option><option value="http://lesca.me/topics/tutorial">教程 Tutorials</option><option value="http://lesca.me/topics/projects">项目 Projects</option><option value="http://lesca.me/topics/projects/ovm">- VPN</option><option value="http://lesca.me/topics/projects/websh">- Websh</option><option value="http://man.lesca.me/">- Docs</option><option value="http://lesca.me/topics/os">操作系统OS</option><option value="http://lesca.me/topics/os/ubuntu-2">- Ubuntu</option><option value="http://lesca.me/topics/os/kernel">-- Kernel</option><option value="http://lesca.me/topics/os/grub2">-- GRUB2</option><option value="http://lesca.me/topics/os/gdb">-- GDB</option><option value="http://lesca.me/topics/os/windows">- Windows</option><option value="http://lesca.me/topics/network">网络Network</option><option value="http://lesca.me/topics/network/ipv6">- IPv6</option><option value="http://lesca.me/topics/network/apache">- Apache</option><option value="http://lesca.me/topics/network/php">- PHP</option><option value="http://lesca.me/topics/network/http">- HTTP</option><option value="http://lesca.me/topics/network/web">- Web</option><option value="http://lesca.me/topics/network/socket">- SOCKET</option><option value="http://lesca.me/topics/network/iptables">- iptables</option><option value="http://download.lesca.me/">下载 Downloads</option><option value="http://lesca.me/about">留言 Guestbook</option><option value="http://lesca.me/search">搜索本站 Search</option></select>    <ul class="my">
        <li><a href="http://lesca.me/archives/iptables-tutorial-structures-configuratios-examples.html#"><i class="iconfont">Ą</i>关注我</a>
            <ul>
                <li><a href="http://lesca.me/feed" rel="external nofollow" target="_blank"><i class="iconfont">ǣ</i>RSS订阅</a>
                    <ul>
                    <li><a href="http://lesca.me/feed" rel="external nofollow" target="_blank">RSS Feed</a></li>
                    <li><a href="http://mail.qq.com/cgi-bin/feed?u=http://lesca.me/feed" rel="external nofollow" target="_blank">订阅到 QQ邮箱</a></li>
                    <li><a href="http://reader.youdao.com/b.do?keyfrom=bookmarklet&amp;url=http://lesca.me/feed" rel="external nofollow" target="_blank">订阅到 有道阅读</a></li>
                    <li><a href="http://xianguo.com/subscribe?url=http://lesca.me/feed" rel="external nofollow" target="_blank">订阅到 鲜果</a></li>
                    <li><a href="http://www.zhuaxia.com/add_channel.php?sourceid=102&amp;url=http://lesca.me/feed" rel="external nofollow" target="_blank">订阅到 抓虾</a></li>
                    <li><a href="http://www.google.com/ig/add?feedurl=http://lesca.me/feed" rel="external nofollow" target="_blank">订阅到 iGoogle</a></li>
                    </ul>
                </li>
                				            </ul>
        </li>
    </ul>
    </div>
</div>
<div id="content">

<!--面包屑导航调用-->
<div class="mbx-dh">
<div id="crumbs"><a href="http://lesca.me/">首页</a> » <a href="http://lesca.me/topics/network">Network</a> » <a href="http://lesca.me/topics/network/iptables">iptables</a> » <span>iptables详细教程：基础、架构、清空规则、追加规则、应用实例</span></div> 
</div>
<!--面包屑导航结束-->
	<div id="main">
				<div id="article">
			<h1><a href="http://lesca.me/archives/iptables-tutorial-structures-configuratios-examples.html" title="iptables详细教程：基础、架构、清空规则、追加规则、应用实例">iptables详细教程：基础、架构、清空规则、追加规则、应用实例</a></h1>
			<div class="info">
            	<span class="meat_span">作者: lesca</span>
                <span class="meat_span">分类: <a href="http://lesca.me/topics/network/iptables" rel="category tag">iptables</a>, <a href="http://lesca.me/topics/tutorial" rel="category tag">Tutorials</a>, <a href="http://lesca.me/topics/os/ubuntu-2" rel="category tag">Ubuntu</a></span>
                <span class="meat_span">发布时间: 2012-03-23 16:07</span>
                <span class="meat_span"><i class="iconfont">ė</i>浏览 12,438 次</span>
                <span class="meat_span"><i class="iconfont">6</i><a href="http://lesca.me/archives/iptables-tutorial-structures-configuratios-examples.html#comments">3条评论</a></span>
                            </div>
			<div class="text">
			<p>iptables防火墙可以用于创建过滤(filter)与NAT规则。所有Linux发行版都能使用iptables，因此理解如何配置iptables将会帮助你更有效地管理Linux防火墙。如果你是第一次接触iptables，你会觉得它很复杂，但是一旦你理解iptables的工作原理，你会发现其实它很简单。</p>
<p>首先介绍iptables的结构：iptables -&gt; Tables -&gt; Chains -&gt; Rules. 简单地讲，tables由chains组成，而chains又由rules组成。如下图所示。<br>
<span id="more-937"></span><br>
<a href="./iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅_files/iptables-table-chain-rule-structure.png"><img src="./iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅_files/iptables-table-chain-rule-structure.png" alt="" title="iptables-table-chain-rule-structure" width="540" height="400" class="alignnone size-full wp-image-941" srcset="http://lesca.me/wp-content/uploads/2012/03/iptables-table-chain-rule-structure.png 540w, http://lesca.me/wp-content/uploads/2012/03/iptables-table-chain-rule-structure-300x222.png 300w" sizes="(max-width: 540px) 100vw, 540px"></a><br>
图: IPTables Table, Chain, and Rule Structure</p>
<h2>一、iptables的表与链</h2>
<p>iptables具有Filter, NAT, Mangle, Raw四种内建表：</p>
<h3>1. Filter表</h3>
<p>Filter表示iptables的默认表，因此如果你没有自定义表，那么就默认使用filter表，它具有以下三种内建链：</p>
<ul>
<li><strong>INPUT链</strong> – 处理来自外部的数据。</li>
<li><strong>OUTPUT链</strong> – 处理向外发送的数据。</li>
<li><strong>FORWARD链</strong> – 将数据转发到本机的其他网卡设备上。</li>
</ul>
<h3>2. NAT表</h3>
<p>NAT表有三种内建链：</p>
<ul>
<li><strong>PREROUTING链</strong> – 处理刚到达本机并在路由转发前的数据包。它会转换数据包中的目标IP地址（destination ip address），通常用于DNAT(destination NAT)。</li>
<li><strong>POSTROUTING链</strong> – 处理即将离开本机的数据包。它会转换数据包中的源IP地址（source ip address），通常用于SNAT（source NAT）。</li>
<li><strong>OUTPUT链</strong> – 处理本机产生的数据包。</li>
</ul>
<h3>3. Mangle表</h3>
<p>Mangle表用于指定如何处理数据包。它能改变TCP头中的QoS位。Mangle表具有5个内建链：</p>
<ul>
<li>PREROUTING</li>
<li>OUTPUT</li>
<li>FORWARD</li>
<li>INPUT</li>
<li>POSTROUTING</li>
</ul>
<h3>4. Raw表</h3>
<p>Raw表用于处理异常，它具有2个内建链：</p>
<ul>
<li>PREROUTING chain</li>
<li>OUTPUT chain</li>
</ul>
<h3>5.小结</h3>
<p>下图展示了iptables的三个内建表：<br>
<a href="./iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅_files/iptables-filter-nat-mangle-tables.png"><img src="./iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅_files/iptables-filter-nat-mangle-tables.png" alt="" title="iptables-filter-nat-mangle-tables" width="540" height="279" class="alignnone size-full wp-image-942" srcset="http://lesca.me/wp-content/uploads/2012/03/iptables-filter-nat-mangle-tables.png 540w, http://lesca.me/wp-content/uploads/2012/03/iptables-filter-nat-mangle-tables-300x155.png 300w" sizes="(max-width: 540px) 100vw, 540px"></a><br>
图: IPTables 内建表</p>
<h2>二、IPTABLES 规则(Rules)</h2>
<p>牢记以下三点式理解iptables规则的关键：</p>
<ul>
<li>Rules包括一个条件和一个目标(target)</li>
<li>如果满足条件，就执行目标(target)中的规则或者特定值。</li>
<li>如果不满足条件，就判断下一条Rules。</li>
</ul>
<h3>目标值（Target Values）</h3>
<p>下面是你可以在target里指定的特殊值：</p>
<ul>
<li><strong>ACCEPT</strong> – 允许防火墙接收数据包</li>
<li><strong>DROP</strong> – 防火墙丢弃包</li>
<li><strong>QUEUE</strong> – 防火墙将数据包移交到用户空间</li>
<li><strong>RETURN</strong> – 防火墙停止执行当前链中的后续Rules，并返回到调用链(the calling chain)中。</li>
</ul>
<p>如果你执行<code>iptables --list</code>你将看到防火墙上的可用规则。下例说明当前系统没有定义防火墙，你可以看到，它显示了默认的filter表，以及表内默认的input链, forward链, output链。</p>
<pre># iptables -t filter --list
Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
</pre>
<p>查看mangle表：</p>
<pre># iptables -t mangle --list
</pre>
<p>查看NAT表：</p>
<pre># iptables -t nat --list
</pre>
<p>查看RAW表：</p>
<pre># iptables -t raw --list
</pre>
<p>/!\注意：如果不指定<strong>-t</strong>选项，就只会显示默认的<strong>filter</strong>表。因此，以下两种命令形式是一个意思：</p>
<pre># iptables -t filter --list
(or)
# iptables --list
</pre>
<p>以下例子表明在filter表的input链, forward链, output链中存在规则：</p>
<pre># iptables --list
Chain INPUT (policy ACCEPT)
num  target     prot opt source               destination
1    RH-Firewall-1-INPUT  all  --  0.0.0.0/0            0.0.0.0/0

Chain FORWARD (policy ACCEPT)
num  target     prot opt source               destination
1    RH-Firewall-1-INPUT  all  --  0.0.0.0/0            0.0.0.0/0

Chain OUTPUT (policy ACCEPT)
num  target     prot opt source               destination

Chain RH-Firewall-1-INPUT (2 references)
num  target     prot opt source               destination
1    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0
2    ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0           icmp type 255
3    ACCEPT     esp  --  0.0.0.0/0            0.0.0.0/0
4    ACCEPT     ah   --  0.0.0.0/0            0.0.0.0/0
5    ACCEPT     udp  --  0.0.0.0/0            224.0.0.251         udp dpt:5353
6    ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0           udp dpt:631
7    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           tcp dpt:631
8    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED
9    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           state NEW tcp dpt:22
10   REJECT     all  --  0.0.0.0/0            0.0.0.0/0           reject-with icmp-host-prohibited
</pre>
<p>以上输出包含下列字段：</p>
<ul>
num – 指定链中的规则编号<br>
target – 前面提到的target的特殊值<br>
prot – 协议：tcp, udp, icmp等<br>
source – 数据包的源IP地址<br>
destination – 数据包的目标IP地址
</ul>
<h2>三、清空所有iptables规则</h2>
<p>在配置iptables之前，你通常需要用<code>iptables --list</code>命令或者<code>iptables-save</code>命令查看有无现存规则，因为有时需要删除现有的iptables规则：</p>
<pre>iptables --flush
或者
iptables -F
</pre>
<p>这两条命令是等效的。但是并非执行后就万事大吉了。你仍然需要检查规则是不是真的清空了，因为有的linux发行版上这个命令不会清除NAT表中的规则，此时只能手动清除：</p>
<pre>iptables -t NAT -F
</pre>
<h2>四、永久生效</h2>
<p>当你删除、添加规则后，这些更改并不能永久生效，这些规则很有可能在系统重启后恢复原样。为了让配置永久生效，根据平台的不同，具体操作也不同。下面进行简单介绍：</p>
<h3>1.Ubuntu</h3>
<p>首先，保存现有的规则：</p>
<pre>iptables-save &gt; /etc/iptables.rules
</pre>
<p>然后新建一个bash脚本，并保存到<var>/etc/network/if-pre-up.d/</var>目录下：</p>
<pre>#!/bin/bash
iptables-restore &lt; /etc/iptables.rules
</pre>
<p>这样，每次系统重启后iptables规则都会被自动加载。<br>
/!\注意：不要尝试在.bashrc或者.profile中执行以上命令，因为用户通常不是root，而且这只能在登录时加载iptables规则。</p>
<h3>2.CentOS, RedHat</h3>
<pre># 保存iptables规则
service iptables save

# 重启iptables服务
service iptables stop
service iptables start
</pre>
<p>查看当前规则：</p>
<pre>cat  /etc/sysconfig/iptables
</pre>
<h2>五、追加iptables规则</h2>
<p>可以使用<code>iptables -A</code>命令追加新规则，其中<strong>-A</strong>表示<strong>Append</strong>。因此，<strong>新的规则将追加到链尾。</strong><br>
一般而言，最后一条规则用于丢弃(DROP)所有数据包。如果你已经有这样的规则了，并且使用<strong>-A</strong>参数添加新规则，那么就是无用功。</p>
<h3>1.语法</h3>
<pre>iptables -A chain firewall-rule
</pre>
<ul>
<li>-A chain – 指定要追加规则的链</li>
<li>firewall-rule – 具体的规则参数</li>
</ul>
<h3>2.描述规则的基本参数</h3>
<p>以下这些规则参数用于描述数据包的协议、源地址、目的地址、允许经过的网络接口，以及如何处理这些数据包。这些描述是对规则的基本描述。</p>
<h3>-p 协议（protocol）</h3>
<ul>
<li>指定规则的协议，如tcp, udp, icmp等，可以使用<strong>all</strong>来指定所有协议。</li>
<li>如果不指定<strong>-p</strong>参数，则默认是<strong>all</strong>值。这并不明智，请总是明确指定协议名称。</li>
<li>可以使用协议名(如tcp)，或者是协议值（比如6代表tcp）来指定协议。映射关系请查看<var>/etc/protocols</var></li>
<li>还可以使用<strong>–protocol</strong>参数代替<strong>-p</strong>参数</li>
</ul>
<h3>-s 源地址（source）</h3>
<ul>
<li>指定数据包的源地址</li>
<li>参数可以使IP地址、网络地址、主机名</li>
<li>例如：-s 192.168.1.101指定IP地址</li>
<li>例如：-s 192.168.1.10/24指定网络地址</li>
<li>如果不指定-s参数，就代表所有地址</li>
<li>还可以使用<strong>–src</strong>或者<strong>–source</strong></li>
</ul>
<h3>-d 目的地址（destination）</h3>
<ul>
<li>指定目的地址</li>
<li>参数和<strong>-s</strong>相同</li>
<li>还可以使用<strong>–dst</strong>或者<strong>–destination</strong></li>
</ul>
<h3>-j 执行目标（jump to target）</h3>
<ul>
<li><strong>-j</strong>代表”jump to target”</li>
<li><strong>-j</strong>指定了当与规则(Rule)匹配时如何处理数据包</li>
<li>可能的值是ACCEPT, DROP, QUEUE, RETURN</li>
<li>还可以指定其他链（Chain）作为目标</li>
</ul>
<h3>-i 输入接口（input interface）</h3>
<ul>
<li><strong>-i</strong>代表输入接口(input interface)</li>
<li><strong>-i</strong>指定了要处理来自哪个接口的数据包</li>
<li>这些数据包即将进入INPUT, FORWARD, PREROUTE链</li>
<li>例如：<strong>-i eth0</strong>指定了要处理经由eth0进入的数据包</li>
<li>如果不指定<strong>-i</strong>参数，那么将处理进入所有接口的数据包</li>
<li>如果出现<strong>!</strong> -i eth0，那么将处理所有经由<strong>eth0以外的接口</strong>进入的数据包</li>
<li>如果出现-i eth<strong>+</strong>，那么将处理所有经由<strong>eth开头的接口</strong>进入的数据包</li>
<li>还可以使用<strong>–in-interface</strong>参数</li>
</ul>
<h3>-o 输出（out interface）</h3>
<ul>
<li><strong>-o</strong>代表”output interface”</li>
<li><strong>-o</strong>指定了数据包由哪个接口输出</li>
<li>这些数据包即将进入FORWARD, OUTPUT, POSTROUTING链</li>
<li>如果不指定<strong>-o</strong>选项，那么系统上的所有接口都可以作为输出接口</li>
<li>如果出现<strong>!</strong> -o eth0，那么将从<strong>eth0以外的接口</strong>输出</li>
<li>如果出现-i eth<strong>+</strong>，那么将仅从<strong>eth开头的接口</strong>输出</li>
<li>还可以使用<strong>–out-interface</strong>参数</li>
</ul>
<h3>3.描述规则的扩展参数</h3>
<p>对规则有了一个基本描述之后，有时候我们还希望指定端口、TCP标志、ICMP类型等内容。</p>
<h3>–sport 源端口（source port）针对 -p tcp 或者 -p udp</h3>
<ul>
<li>缺省情况下，将匹配所有端口</li>
<li>可以指定端口号或者端口名称，例如”–sport 22″与”–sport ssh”。</li>
<li><var>/etc/services</var>文件描述了上述映射关系。</li>
<li>从性能上讲，使用端口号更好</li>
<li>使用冒号可以匹配端口范围，如”–sport 22:100″</li>
<li>还可以使用”–source-port”</li>
</ul>
<h3>–-dport 目的端口（destination port）针对-p tcp 或者 -p udp</h3>
<ul>
<li>参数和–sport类似</li>
<li>还可以使用”–destination-port”</li>
</ul>
<h3>-–tcp-flags TCP标志 针对-p tcp</h3>
<ul>
<li>可以指定由逗号分隔的多个参数</li>
<li>有效值可以是：SYN, ACK, FIN, RST, URG, PSH</li>
<li>可以使用<strong>ALL</strong>或者<strong>NONE</strong></li>
</ul>
<h3>-–icmp-type ICMP类型 针对-p icmp</h3>
<ul>
<li>–icmp-type 0 表示Echo Reply</li>
<li>–icmp-type 8 表示Echo</li>
</ul>
<h3>4.追加规则的完整实例：仅允许SSH服务</h3>
<p>本例实现的规则将仅允许SSH数据包通过本地计算机，其他一切连接（包括ping）都将被拒绝。</p>
<pre># 1.清空所有iptables规则
iptables -F

# 2.接收目标端口为22的数据包
iptables -A INPUT -i eth0 -p tcp --dport 22 -j ACCEPT

# 3.拒绝所有其他数据包
iptables -A INPUT -j DROP
</pre>
<h2>六、更改默认策略</h2>
<p>上例的例子仅对接收的数据包过滤，而对于要发送出去的数据包却没有任何限制。本节主要介绍如何更改链策略，以改变链的行为。</p>
<h3>1. 默认链策略</h3>
<p><strong>/!\警告</strong>：请勿在远程连接的服务器、虚拟机上测试！<br>
当我们使用-L选项验证当前规则是发现，所有的链旁边都有<strong>policy ACCEPT</strong>标注，这表明当前链的默认策略为ACCEPT：</p>
<pre># iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination
ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:ssh
DROP       all  --  anywhere             anywhere            

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
</pre>
<p>这种情况下，如果没有明确添加DROP规则，那么默认情况下将采用ACCEPT策略进行过滤。除非：<br>
<strong>a)为以上三个链单独添加DROP规则：</strong></p>
<pre>iptables -A INPUT -j DROP
iptables -A OUTPUT -j DROP
iptables -A FORWARD -j DROP
</pre>
<p><strong>b)更改默认策略：</strong></p>
<pre>iptables -P INPUT DROP
iptables -P OUTPUT DROP
iptables -P FORWARD DROP
</pre>
<p>糟糕！！如果你严格按照上一节的例子配置了iptables，并且现在使用的是SSH进行连接的，那么会话恐怕已经被迫终止了！<br>
为什么呢？因为我们已经把OUTPUT链策略更改为DROP了。此时虽然服务器能接收数据，但是无法发送数据：</p>
<pre># iptables -L
Chain INPUT <strong>(policy DROP)</strong>
target     prot opt source               destination
ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:ssh
DROP       all  --  anywhere             anywhere            

Chain FORWARD <strong>(policy DROP)</strong>
target     prot opt source               destination         

Chain OUTPUT <strong>(policy DROP)</strong>
target     prot opt source               destination
</pre>
<h2>七、配置应用程序规则</h2>
<p>尽管5.4节已经介绍了如何初步限制除SSH以外的其他连接，但是那是在链默认策略为ACCEPT的情况下实现的，并且没有对输出数据包进行限制。本节在上一节基础上，以SSH和HTTP所使用的端口为例，教大家如何在默认链策略为DROP的情况下，进行防火墙设置。在这里，我们将引进一种新的参数-m state，并检查数据包的状态字段。</p>
<h3>1.SSH</h3>
<pre># 1.允许接收远程主机的SSH请求
iptables -A INPUT -i eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT

# 2.允许发送本地主机的SSH响应
iptables -A OUTPUT -o eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT
</pre>
<ul>
<li><strong>-m state:</strong> 启用状态匹配模块（state matching module）</li>
<li><strong>–-state:</strong> 状态匹配模块的参数。当SSH客户端第一个数据包到达服务器时，状态字段为NEW；建立连接后数据包的状态字段都是ESTABLISHED</li>
<li><strong>–sport 22:</strong> sshd监听22端口，同时也通过该端口和客户端建立连接、传送数据。因此对于SSH服务器而言，源端口就是22</li>
<li><strong>–dport 22:</strong> ssh客户端程序可以从本机的随机端口与SSH服务器的22端口建立连接。因此对于SSH客户端而言，目的端口就是22</li>
</ul>
<p>如果服务器也需要使用SSH连接其他远程主机，则还需要增加以下配置：</p>
<pre># 1.送出的数据包目的端口为22
iptables -A OUTPUT -o eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT

# 2.接收的数据包源端口为22
iptables -A INPUT -i eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT
</pre>
<h3>2.HTTP</h3>
<p>HTTP的配置与SSH类似：</p>
<pre># 1.允许接收远程主机的HTTP请求
iptables -A INPUT -i eth0 -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT

# 1.允许发送本地主机的HTTP响应
iptables -A OUTPUT -o eth0 -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT
</pre>
<h3>3.完整的配置</h3>
<pre># 1.删除现有规则
iptables -F

# 2.配置默认链策略
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT DROP

# 3.允许远程主机进行SSH连接
iptables -A INPUT -i eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT

# 4.允许本地主机进行SSH连接
iptables -A OUTPUT -o eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A INPUT -i eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT

# 5.允许HTTP请求
iptables -A INPUT -i eth0 -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT
</pre>
<h2>References</h2>
<p>[1] <a href="http://www.thegeekstuff.com/2011/01/iptables-fundamentals/">Linux Firewall Tutorial: IPTables Tables, Chains, Rules Fundamentals</a><br>
[2] <a href="http://www.thegeekstuff.com/2011/01/redhat-iptables-flush/">IPTables Flush: Delete / Remove All Rules On RedHat and CentOS Linux</a><br>
[3] <a href="http://www.thegeekstuff.com/2011/02/iptables-add-rule/">Linux IPTables: How to Add Firewall Rules (With Allow SSH Example)</a><br>
[4] <a href="http://www.thegeekstuff.com/2011/03/iptables-inbound-and-outbound-rules/">Linux IPTables: Incoming and Outgoing Rule Examples (SSH and HTTP)</a><br>
[5] <a href="http://www.thegeekstuff.com/2011/06/iptables-rules-examples/">25 Most Frequently Used Linux IPTables Rules Examples</a><br>
[6] man 8 iptables </p>
			<!--文章分页效果-->
						<!--文章分页结束-->
			</div>
            <div class="text_add">
                <div class="copy"><p style="color:#fe9800;">本文出自 Lesca技术宅，转载时请注明出处及相应链接。</p><p style="color:#777;font-size:12px;">本文永久链接: <a href="http://lesca.me/archives/iptables-tutorial-structures-configuratios-examples.html" target="_blank">http://lesca.me/archives/iptables-tutorial-structures-configuratios-examples.html</a></p></div>
                <div class="share">
								<!-- 百度分享按钮 
				<div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="bds_t163" data-cmd="t163" title="分享到网易微博"></a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=86835285.js?cdnversion='+~(-new Date()/36e5)];</script>
				<!-- 百度分享按钮结束 -->
								</div>
                </div>
			<div class="meta"><i class="iconfont">0</i><a href="http://lesca.me/tags/chain" rel="tag">chain</a>, <a href="http://lesca.me/tags/iptables" rel="tag">iptables</a>, <a href="http://lesca.me/tags/rule" rel="tag">rule</a>, <a href="http://lesca.me/tags/structure" rel="tag">structure</a>, <a href="http://lesca.me/tags/table" rel="tag">table</a></div>
		</div>

		<!--cnzz tui-->
				<!--cnzz tui-->

		        <div class="post_link">
			<div class="prev">« <a href="http://lesca.me/archives/linux-file-permission-sticky-bit-suid-sgid.html" rel="prev">Linux文件权限：Sticky bit, SUID, SGID</a></div>
			<div class="next"><a href="http://lesca.me/archives/iptables-examples.html" rel="next">iptables常用规则：屏蔽IP地址、禁用ping、协议设置、NAT与转发、负载平衡、自定义链</a> »</div>
        </div>
        
        <div id="comments">			<h3>3 Comments</h3>

		<ol class="comment_list">
				<li class="pingback even thread-even depth-1" id="comment-3366">
		<p>Pingback: <a href="http://www.thinkfreesky.com/170.html" rel="external nofollow" target="_blank">Linux下iptables设置详解 | Think</a> </p>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-21459">
		<p>Pingback: <a href="http://guanzi.info/?p=100" rel="external nofollow" target="_blank">iptables详细教程：基础、架构、清空规则、追加规则、应用实例（绝对入门级） | Guanzi的博客</a> </p>
	</li><!-- #comment-## -->
	<li class="pingback even thread-even depth-1" id="comment-22381">
		<p>Pingback: <a href="http://guanzi.info/2013/08/iptables%e8%af%a6%e7%bb%86%e6%95%99%e7%a8%8b%ef%bc%9a%e5%9f%ba%e7%a1%80%e3%80%81%e6%9e%b6%e6%9e%84%e3%80%81%e6%b8%85%e7%a9%ba%e8%a7%84%e5%88%99%e3%80%81%e8%bf%bd%e5%8a%a0%e8" rel="external nofollow" target="_blank">iptables详细教程：基础、架构、清空规则、追加规则、应用实例（绝对入门级） | Guanzi的博客</a> </p>
	</li><!-- #comment-## -->
		</ol>

		        

	
					<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://lesca.me/archives/iptables-tutorial-structures-configuratios-examples.html#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="http://lesca.me/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required="true" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="937" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="25aabbc423"></p><p style="display: none;"></p>				<input type="hidden" id="ak_js" name="ak_js" value="1476170421037"></form>
					</div><!-- #respond -->
		</div>
	</div>
	<div id="sidebar">
    <div id="search">
	    <form id="searchform" method="get" action="http://lesca.me/">
		    <input type="text" value="" name="s" id="s" size="30" x-webkit-speech="">
			<button type="submit" id="searchsubmit"><i class="iconfont">ő</i></button>
		</form>
    </div>
    <div class="sidebar">
	    <div class="widget">
		<h3>分类目录</h3>
		<ul>
    			<li class="cat-item cat-item-515"><a href="http://lesca.me/topics/active-directory-2">Active Directory</a> (9)
</li>
	<li class="cat-item cat-item-319"><a href="http://lesca.me/topics/apple">Apple</a> (3)
</li>
	<li class="cat-item cat-item-103"><a href="http://lesca.me/topics/arm">ARM</a> (9)
</li>
	<li class="cat-item cat-item-441"><a href="http://lesca.me/topics/bitcoin">Bitcoin</a> (2)
</li>
	<li class="cat-item cat-item-416"><a href="http://lesca.me/topics/cad">CAD</a> (2)
</li>
	<li class="cat-item cat-item-4"><a href="http://lesca.me/topics/concept" title="概念">Concept</a> (33)
</li>
	<li class="cat-item cat-item-286"><a href="http://lesca.me/topics/life">life</a> (5)
</li>
	<li class="cat-item cat-item-264"><a href="http://lesca.me/topics/math">Math</a> (3)
</li>
	<li class="cat-item cat-item-221"><a href="http://lesca.me/topics/network">Network</a> (41)
</li>
	<li class="cat-item cat-item-403"><a href="http://lesca.me/topics/os" title="Operating System">OS</a> (104)
</li>
	<li class="cat-item cat-item-553"><a href="http://lesca.me/topics/powershell-2">Powershell</a> (4)
</li>
	<li class="cat-item cat-item-155"><a href="http://lesca.me/topics/projects">Projects</a> (8)
</li>
	<li class="cat-item cat-item-588"><a href="http://lesca.me/topics/security">Security</a> (1)
</li>
	<li class="cat-item cat-item-383"><a href="http://lesca.me/topics/sql">SQL</a> (4)
</li>
	<li class="cat-item cat-item-595"><a href="http://lesca.me/topics/troubleshoot">Troubleshoot</a> (1)
</li>
	<li class="cat-item cat-item-3"><a href="http://lesca.me/topics/tutorial" title="教程">Tutorials</a> (140)
</li>
	<li class="cat-item cat-item-1"><a href="http://lesca.me/topics/uncategorized">Uncategorized</a> (2)
</li>
	<li class="cat-item cat-item-8"><a href="http://lesca.me/topics/wordpress">wordpress</a> (1)
</li>
		</ul>
	</div>
	<div id="related_post" class="widget">
		<h3>iptables 下的最新文章</h3>
		<ul><li><a href="http://lesca.me/archives/block-ssh-dictionary-attack-with-iptables.html">iptables：阻止SSH字典攻击</a></li><li><a href="http://lesca.me/archives/iptables-examples.html">iptables常用规则：屏蔽IP地址、禁用ping、协议设置、NAT与转发、负载平衡、自定义链</a></li><li><a href="http://lesca.me/archives/iptables-nat-mangle-clear-rules.html">iptables应用：NAT、数据报处理、清空iptables规则</a></li><li><a href="http://lesca.me/archives/iptables-architecture-commands-extensions.html">iptables入门：iptables构架、基本命令及扩展（功能）简介</a></li><li><a href="http://lesca.me/archives/iptables-snat-dnat-masquerade.html">iptables: SNAT, DNAT, MASQUERADE的联系与区别</a></li></ul><ul><li><a href="http://lesca.me/archives/debian-or-raspbian-nfs-kernel-server-not-starting-portmapper-is-not-running.html">Debian or Raspbian: nfs-kernel-server not starting portmapper is not running</a></li><li><a href="http://lesca.me/archives/uid-functions-for-hp-servers.html">HP 服务器 UID 指示灯的作用</a></li><li><a href="http://lesca.me/archives/greenize-and-customize-google-chrome-v29.html">Google Chrome 绿化与个性化教程</a></li><li><a href="http://lesca.me/archives/test-peer-to-peer-connection-with-iperf3.html">Test Peer to Peer Connection Speed with iperf3</a></li><li><a href="http://lesca.me/archives/backup-and-restore-the-mysql-slave-server.html">备份与还原MySQL从服务器</a></li><li><a href="http://lesca.me/archives/mysql-master-slave-replication-on-centos-7.html">在CentOS 7上配置MySQL的主从复制模式 (Master-Slave Replication)</a></li><li><a href="http://lesca.me/archives/how-to-configure-your-proxy-client.html">How to configure your proxy client</a></li><li><a href="http://lesca.me/archives/speed-up-your-web-with-dnsmasq-and-squid.html">加速WEB访问：使用DNSmasq与squid代理并过滤广告</a></li><li><a href="http://lesca.me/archives/ios8-does-not-support-cisco-ap-local-radius-server.html">坑爹！iOS8不支持LEAP了！</a></li><li><a href="http://lesca.me/archives/vsphere-client-ports-redirect-with-portproxy-on-windows-7.html">vSphere Client: Ports redirect with portproxy on Windows 7 (端口转发)</a></li></ul><ul><li><a href="http://lesca.me/archives/enable-ipv6-for-nginx.html">Nginx: 开启Ipv6</a></li><li><a href="http://lesca.me/archives/set-timezone-with-command-line-on-ubuntu.html">Ubuntu: 以命令行方式修改时区</a></li><li><a href="http://lesca.me/archives/lspci-know-your-linux-server-hardware.html">lspci: 了解Linux服务器硬件信息</a></li><li><a href="http://lesca.me/archives/quickly-deploy-vpn-on-ubuntu-with-ovm.html">OVM：在Ubuntu上快速部署OpenVPN, L2TP, PPTP服务</a></li><li><a href="http://lesca.me/archives/compress-and-decompress-lzma-pacakge.html">Ubuntu: 压缩与解压缩LZMA文件</a></li><li><a href="http://lesca.me/archives/mine-bitcoin-on-cpu-with-cgminer.html">Ubuntu: 用cgminer挖掘CPU比特币(bitcoin)</a></li><li><a href="http://lesca.me/archives/mine-bitcoin-on-cpu-with-ufasoft-bitcoin-miner.html">Ubuntu: 用ufasoft bitcoinn miner挖掘CPU比特币(bitcoin)</a></li><li><a href="http://lesca.me/archives/ppasearch-search-the-ppa.html">ppasearch: search the ppa</a></li><li><a href="http://lesca.me/archives/how-to-rebuild-sources-list.html">apt-get: 恢复sources.list</a></li><li><a href="http://lesca.me/archives/compile-bash-shell-with-shc.html">使用SHC加密bash脚本程序</a></li></ul>	</div>
    <div class="widget">
		<h3>随机文章</h3>
		<ul>
    		    		<li><a href="http://lesca.me/archives/lost-packages-on-backbone-network.html" title="上海电信、江苏电信骨干网节点丢包">上海电信、江苏电信骨干网节点丢包</a></li>
    		    		<li><a href="http://lesca.me/archives/a-quick-introduction-to-winpe-imagex-and-dism.html" title="创建WinPE启动盘、常用imagex指令、常用dism指令">创建WinPE启动盘、常用imagex指令、常用di...</a></li>
    		    		<li><a href="http://lesca.me/archives/wordpress-permission-issue-on-centos-7.html" title="CentOS 7 安装wordpress 权限问题">CentOS 7 安装wordpress 权限问题</a></li>
    		    		<li><a href="http://lesca.me/archives/windows-xp-environment-variables.html" title="Windows XP: cmd常用环境变量概览">Windows XP: cmd常用环境变量概览</a></li>
    		    		<li><a href="http://lesca.me/archives/mysql-master-slave-replication-on-centos-7.html" title="在CentOS 7上配置MySQL的主从复制模式 (Master-Slave Replication)">在CentOS 7上配置MySQL的主从复制模式 (Ma...</a></li>
    		    		<li><a href="http://lesca.me/archives/vsphere-client-ports-redirect-with-portproxy-on-windows-7.html" title="vSphere Client: Ports redirect with portproxy on Windows 7 (端口转发)">vSphere Client: Ports redirect with por...</a></li>
    		    		<li><a href="http://lesca.me/archives/set-timezone-with-command-line-on-ubuntu.html" title="Ubuntu: 以命令行方式修改时区">Ubuntu: 以命令行方式修改时区</a></li>
    		    		<li><a href="http://lesca.me/archives/makefiles.html" title="Makefile入门">Makefile入门</a></li>
    		    		<li><a href="http://lesca.me/archives/remove-extra-grub2-boot-item-on-ubuntu.html" title="三、GRUB2：删除内核文件，删除多余引导菜单项">三、GRUB2：删除内核文件，删除多余引导菜...</a></li>
    		    		<li><a href="http://lesca.me/archives/access-google-directl.html" title="强制直接访问Google.Com而不跳转至Google.Com.Hk">强制直接访问Google.Com而不跳转至Google....</a></li>
    				</ul>
	</div>
    <div class="widget">
		<h3>标签云</h3>
        <div class="tagcloud"><a href="http://lesca.me/tags/htaccess" class="tag-link-379 tag-link-position-1" title="4 topics" style="color:#c60548;font-size: 11.948717948718pt;;">.htaccess</a>
<a href="http://lesca.me/tags/ad" class="tag-link-507 tag-link-position-2" title="4 topics" style="color:#dabd54;font-size: 11.948717948718pt;;">ad</a>
<a href="http://lesca.me/tags/apache" class="tag-link-606 tag-link-position-3" title="3 topics" style="color:#ea89a4;font-size: 10.153846153846pt;;">Apache</a>
<a href="http://lesca.me/tags/apt-get" class="tag-link-112 tag-link-position-4" title="2 topics" style="color:#cf14de;font-size: 8pt;;">apt-get</a>
<a href="http://lesca.me/tags/brcm47xx" class="tag-link-577 tag-link-position-5" title="4 topics" style="color:#c9550e;font-size: 11.948717948718pt;;">brcm47xx</a>
<a href="http://lesca.me/tags/chrome" class="tag-link-91 tag-link-position-6" title="5 topics" style="color:#6da62a;font-size: 13.384615384615pt;;">chrome</a>
<a href="http://lesca.me/tags/dc" class="tag-link-316 tag-link-position-7" title="4 topics" style="color:#6b2477;font-size: 11.948717948718pt;;">DC</a>
<a href="http://lesca.me/tags/disk" class="tag-link-150 tag-link-position-8" title="2 topics" style="color:#370c28;font-size: 8pt;;">disk</a>
<a href="http://lesca.me/tags/gdb" class="tag-link-614 tag-link-position-9" title="2 topics" style="color:#d1c34b;font-size: 8pt;;">GDB</a>
<a href="http://lesca.me/tags/goagent" class="tag-link-576 tag-link-position-10" title="4 topics" style="color:#c971dc;font-size: 11.948717948718pt;;">goagent</a>
<a href="http://lesca.me/tags/grub" class="tag-link-24 tag-link-position-11" title="4 topics" style="color:#a81407;font-size: 11.948717948718pt;;">GRUB</a>
<a href="http://lesca.me/tags/grub2" class="tag-link-612 tag-link-position-12" title="4 topics" style="color:#4af623;font-size: 11.948717948718pt;;">GRUB2</a>
<a href="http://lesca.me/tags/http%e5%8d%8f%e8%ae%ae" class="tag-link-84 tag-link-position-13" title="2 topics" style="color:#d8020e;font-size: 8pt;;">HTTP协议</a>
<a href="http://lesca.me/tags/http%e6%8a%a5%e6%96%87" class="tag-link-87 tag-link-position-14" title="2 topics" style="color:#fca121;font-size: 8pt;;">HTTP报文</a>
<a href="http://lesca.me/tags/iptables" class="tag-link-615 tag-link-position-15" title="7 topics" style="color:#d2fad0;font-size: 15.538461538462pt;;">iptables</a>
<a href="http://lesca.me/tags/ipv6-2" class="tag-link-472 tag-link-position-16" title="10 topics" style="color:#41cd8c;font-size: 18.051282051282pt;;">ipv6</a>
<a href="http://lesca.me/tags/kernel" class="tag-link-613 tag-link-position-17" title="2 topics" style="color:#a6d184;font-size: 8pt;;">Kernel</a>
<a href="http://lesca.me/tags/linux" class="tag-link-152 tag-link-position-18" title="5 topics" style="color:#b1edc5;font-size: 13.384615384615pt;;">linux</a>
<a href="http://lesca.me/tags/mini2440" class="tag-link-104 tag-link-position-19" title="2 topics" style="color:#3121de;font-size: 8pt;;">mini2440</a>
<a href="http://lesca.me/tags/nat" class="tag-link-211 tag-link-position-20" title="4 topics" style="color:#813d84;font-size: 11.948717948718pt;;">NAT</a>
<a href="http://lesca.me/tags/nfs" class="tag-link-116 tag-link-position-21" title="3 topics" style="color:#63cffa;font-size: 10.153846153846pt;;">NFS</a>
<a href="http://lesca.me/tags/openssl" class="tag-link-239 tag-link-position-22" title="3 topics" style="color:#d0562;font-size: 10.153846153846pt;;">openssl</a>
<a href="http://lesca.me/tags/openvpn" class="tag-link-227 tag-link-position-23" title="4 topics" style="color:#7a94e1;font-size: 11.948717948718pt;;">openvpn</a>
<a href="http://lesca.me/tags/openwrt" class="tag-link-616 tag-link-position-24" title="5 topics" style="color:#ad9627;font-size: 13.384615384615pt;;">OpenWRT</a>
<a href="http://lesca.me/tags/php" class="tag-link-607 tag-link-position-25" title="3 topics" style="color:#16592f;font-size: 10.153846153846pt;;">PHP</a>
<a href="http://lesca.me/tags/powershell" class="tag-link-540 tag-link-position-26" title="5 topics" style="color:#ed8501;font-size: 13.384615384615pt;;">powershell</a>
<a href="http://lesca.me/tags/signal" class="tag-link-170 tag-link-position-27" title="2 topics" style="color:#1f591f;font-size: 8pt;;">signal</a>
<a href="http://lesca.me/tags/sql-server" class="tag-link-287 tag-link-position-28" title="3 topics" style="color:#9deba4;font-size: 10.153846153846pt;;">Sql server</a>
<a href="http://lesca.me/tags/ssh" class="tag-link-134 tag-link-position-29" title="6 topics" style="color:#9d6f43;font-size: 14.641025641026pt;;">SSH</a>
<a href="http://lesca.me/tags/telnet" class="tag-link-76 tag-link-position-30" title="2 topics" style="color:#193007;font-size: 8pt;;">Telnet</a>
<a href="http://lesca.me/tags/telnet%e8%bf%9e%e6%8e%a5http" class="tag-link-77 tag-link-position-31" title="2 topics" style="color:#c42216;font-size: 8pt;;">telnet连接HTTP</a>
<a href="http://lesca.me/tags/tutorial-2" class="tag-link-558 tag-link-position-32" title="3 topics" style="color:#63748b;font-size: 10.153846153846pt;;">tutorial</a>
<a href="http://lesca.me/tags/ubuntu" class="tag-link-6 tag-link-position-33" title="16 topics" style="color:#f3ed5c;font-size: 21.461538461538pt;;">ubuntu</a>
<a href="http://lesca.me/tags/wallproxy" class="tag-link-580 tag-link-position-34" title="3 topics" style="color:#aeabbb;font-size: 10.153846153846pt;;">wallproxy</a>
<a href="http://lesca.me/tags/win7" class="tag-link-21 tag-link-position-35" title="7 topics" style="color:#32896a;font-size: 15.538461538462pt;;">Win7</a>
<a href="http://lesca.me/tags/windows-2" class="tag-link-23 tag-link-position-36" title="17 topics" style="color:#bd426b;font-size: 22pt;;">windows</a>
<a href="http://lesca.me/tags/wordpress" class="tag-link-605 tag-link-position-37" title="3 topics" style="color:#1c51e5;font-size: 10.153846153846pt;;">wordpress</a>
<a href="http://lesca.me/tags/xp" class="tag-link-422 tag-link-position-38" title="3 topics" style="color:#9dade1;font-size: 10.153846153846pt;;">xp</a>
<a href="http://lesca.me/tags/%e4%b8%8d%e5%8f%af%e9%9d%a0%e6%80%a7" class="tag-link-172 tag-link-position-39" title="2 topics" style="color:#f44e93;font-size: 8pt;;">不可靠性</a>
<a href="http://lesca.me/tags/%e5%8c%ba%e5%88%ab" class="tag-link-44 tag-link-position-40" title="3 topics" style="color:#ee1531;font-size: 10.153846153846pt;;">区别</a>
<a href="http://lesca.me/tags/%e5%8f%af%e9%9d%a0%e6%80%a7" class="tag-link-171 tag-link-position-41" title="2 topics" style="color:#671fbe;font-size: 8pt;;">可靠性</a>
<a href="http://lesca.me/tags/%e5%ae%89%e8%a3%85" class="tag-link-32 tag-link-position-42" title="2 topics" style="color:#9c629b;font-size: 8pt;;">安装</a>
<a href="http://lesca.me/tags/%e5%ae%89%e8%a3%85%e5%86%85%e6%a0%b8" class="tag-link-128 tag-link-position-43" title="2 topics" style="color:#390b55;font-size: 8pt;;">安装内核</a>
<a href="http://lesca.me/tags/%e7%bc%96%e8%af%91%e5%86%85%e6%a0%b8" class="tag-link-127 tag-link-position-44" title="2 topics" style="color:#3f21cd;font-size: 8pt;;">编译内核</a>
<a href="http://lesca.me/tags/%e9%85%8d%e7%bd%ae" class="tag-link-19 tag-link-position-45" title="2 topics" style="color:#9903bc;font-size: 8pt;;">配置</a></div>
	</div>
        </div>
</div></div>
<div id="totop" class="totop" style="display: none;"><i class="iconfont">Ɣ</i>回顶部</div>
<script type="text/javascript">
	$(window).scroll(function () {
        var dt = $(document).scrollTop();
        var wt = $(window).height();
        if (dt <= 0) {
            $("#totop").hide();
            return;
        }
        $("#totop").show();
        if ($.browser.msie && $.browser.version == 6.0) {//IE6返回顶部
            $("#totop").css("top", wt + dt - 110 + "px");
        }
    });
    $("#totop").click(function () { $("html,body").animate({ scrollTop: 0 }, 200) });
</script>
</div>
<div id="footer">
	© 2015 Lesca技术宅.
	Powered by WordPress.
    Theme by <a href="http://tangjie.me/tangstyle" title="TangStyle" target="_blank">TangStyle</a>.
	由<a href="http://www.xiaoz.me/" title="wordpress教程" target="_blank">小z博客</a>优化.
        <p>
                        本站采用创作共用版权协议, 要求署名、非商业用途和保持一致. <br>
                        转载本站内容必须也遵循“署名-非商业用途-保持一致”的创作共用协议.<br>
                        This site is licensed under a <a href="http://creativecommons.org/licenses/by-nc-sa/3.0" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 License</a>.<br>
                        Contact me:<img src="https://lesca.me/wp-content/uploads/email.png" style="position:relative; bottom: -4px;">
        </p>
        </div>
<script type="text/javascript" src="./iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅_files/form.js"></script>
<script type="text/javascript" src="./iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅_files/comment-reply.min.js"></script>
<script type="text/javascript" src="./iptables详细教程：基础、架构、清空规则、追加规则、应用实例 - Lesca技术宅_files/wp-embed.min.js"></script>


</body></html>